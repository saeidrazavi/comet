##### Sample grid coloring #####
from PIL import Image, ImageDraw
from PIL import ImageColor,  ImageEnhance
#to color grid of a random rample, get values from above
yes_parts=  [ 1, 2, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28,29, 31, 33, 34, 35, 36, 40, 41, 42, 47, 48, 49, 50, 51, 52,55,  56, 57, 58, 59, 60, 61, 62, 63, 64]
no_parts= [ 3, 4, 5, 6, 7, 30, 32, 37, 38, 39, 43, 44, 45, 46, 53, 54]
yes_dist=[7.782599925994873,
 7.49560022354126,
 7.400700092315674,
 7.424900054931641,
 7.397200107574463,
 7.344099998474121,
 7.32450008392334,
 7.3256001472473145,
 7.369999885559082,
 7.876100063323975,
 7.872200012207031,
 7.700900077819824,
 7.7779998779296875,
 7.649400234222412,
 7.886899948120117,
 7.957699775695801,
 7.4567999839782715,
 7.675899982452393,
 7.73859977722168,
 7.75439977645874,
 7.911399841308594,
 7.963200092315674,
 7.371200084686279,
 7.619999885559082,
 7.805600166320801,
 7.4679999351501465,
 7.7967000007629395,
 7.690400123596191,
 7.801799774169922,
 7.724400043487549,
 7.274600028991699,
 7.995699882507324,
 7.371099948883057,
 7.825200080871582,
 7.690000057220459,
 7.547100067138672,
 7.780200004577637,
 7.986299991607666,
 7.884200096130371,
 7.984799861907959,
 7.367199897766113,
 7.964799880981445,
 8.180500030517578,
 7.956600189208984,
 7.997799873352051,
 7.77810001373291,
 7.663899898529053,
 8.120200157165527]
no_dist=[7.883399963378906,
 7.766499996185303,
 8.001899719238281,
 7.718699932098389,
 7.838900089263916,
 7.610400199890137,
 7.67080020904541,
 8.133299827575684,
 7.835299968719482,
 7.8125,
 7.558599948883057,
 7.642199993133545,
 7.647200107574463,
 7.8831000328063965,
 7.76639986038208,
 7.759399890899658]
coord= [[1, 14, 14],
[2, 42, 14],
[3, 70, 14],
[4, 98, 14],
[5, 126, 14],
[6, 154, 14],
[7, 182, 14],
[8, 210, 14],
[9, 14, 42],
[10, 42, 42],
[11, 70, 42],
[12, 98, 42],
[13, 126, 42],
[14, 154, 42],
[15, 182, 42],
[16, 210, 42],
[17, 14, 70],
[18, 42, 70],
[19, 70, 70],
[20, 98, 70],
[21, 126, 70],
[22, 154, 70],
[23, 182, 70],
[24, 210, 70],
[25, 14, 98],
[26, 42, 98],
[27, 70, 98],
[28, 98, 98],
[29, 126, 98],
[30, 154, 98],
[31, 182, 98],
[32, 210, 98],
[33, 14, 126],
[34, 42, 126],
[35, 70, 126],
[36, 98, 126],
[37, 126, 126],
[38, 154, 126],
[39, 182, 126],
[40, 210, 126],
[41, 14, 154],
[42, 42, 154],
[43, 70, 154],
[44, 98, 154],
[45, 126, 154],
[46, 154, 154],
[47, 182, 154],
[48, 210, 154],
[49, 14, 182],
[50, 42, 182],
[51, 70, 182],
[52, 98, 182],
[53, 126, 182],
[54, 154, 182],
[55, 182, 182],
[56, 210, 182],
[57, 14, 210],
[58, 42, 210],
[59, 70, 210],
[60, 98, 210],
[61, 126, 210],
[62, 154, 210],
[63, 182, 210],
[64, 210, 210]]
part_coords = {}
max_val = max(max(yes_dist), max(no_dist))
for part in coord:
    part_id, x, y = part
    part_coords[part_id] = (x, y)
input_img = Image.open("test1.png").convert("RGB") #set path to the image 
input_img = input_img.resize((224, 224))
enhancer = ImageEnhance.Contrast(input_img)
factor = 1.5
input_img = enhancer.enhance(factor)
input_img.show()
heatmap_img = Image.new("RGB",input_img.size)
rect_size = 170 
draw = ImageDraw.Draw(heatmap_img)
part_colors = {}
for i in range(64):
    part_id = i + 1
    if part_id in yes_parts:
        ind=yes_parts.index(part_id)
        part_colors[part_id] = 20*(yes_dist[ind-1])
    elif part_id in no_parts:
        ind=no_parts.index(part_id)
        part_colors[part_id] = -2000*(no_dist[ind-1]) 
    else:
        continue
    x, y = part_coords[part_id] 
    color = part_colors[part_id]
    draw.rectangle([(x - rect_size//2, y - rect_size//2), (x + rect_size//2, y + rect_size//2)], fill=int(color))
blended_img = Image.blend(input_img, heatmap_img.convert("RGB"), alpha=0.65)
blended_img.show()